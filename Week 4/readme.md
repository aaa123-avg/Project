# 一、南瓜数据（US-pumpkins.csv）细节说明

## 1. 数据基本构成
核心目标变量：数据中以High Price作为预测目标，所有分析与建模均围绕该变量展开。

特征类型：包含数值特征（价格等）和分类特征（种类、规格、产地、销售城市等），通过plot_categorical_vs_target函数可观察分类特征与High Price的关系。

缺失值处理：通过drop_high_missing_cols函数删除缺失率≥75% 的列（MISSING_THRESHOLD=0.75），原始数据存在部分高缺失特征，保留这些缺失量过大的数据会造成预测误差，所以仅保留特征缺失率较低的数据，可用于建模。

## 2. 关键特征分布与价值分析
日期信息：数据中若包含日期特征，其参考价值较低。通过可视化及相关性分析，发现日期特征较零散且在不同日期呈现相同相关性，说明日期特征对价值分析无显著影响。

分类特征样本分布：通过plot_categorical_vs_target函数对非数值特征（如种类、规格、城市、产地）分组计算High Price平均值，推断样本分布特征及与High Price的相关性。
例如：若 “产地 A” 在多个可视化中稳居前 5，说明其样本量充足且High Price平均值稳定；若某类别未出现在结果中，可能样本量较少或价格无显著规律。

数值特征相关性：analyze_correlation函数计算数值特征与High Price的相关性，识别强关联特征。

# 二、特征处理细节说明

## 1. 特征筛选与预处理逻辑
缺失值处理：优先通过缺失率筛选（删除≥75% 的列），而非直接填充，避免高缺失特征引入噪声。保留的低缺失特征删除缺失行，避免引入误差。

数据集拆分：采用TEST_SIZE=0.2（8:2 拆分训练集与测试集），固定RANDOM_STATE=42确保结果可复现。

## 2. 特征相关性与编码影响
线性相关性分析：通过数值特征与High Price的相关性计算（analyze_correlation），可初步判断特征重要性。树模型（GBDT/LGBM/XGBoost）对多重共线性不敏感（无需严格消除）。

分类特征编码：树模型对离散值编码方式的敏感性低于线性模型：线性模型依赖编码顺序，而树模型通过分裂节点自动处理类别差异，因此编码方式对树模型性能影响较小，选择one-hot编码方式。

特征删除对性能的影响：若数据中包含大量缺失特征，则预测结果会出现偏差，但删除缺失值后导致数据集过小，模型在测试集上的表现不如训练集上表现好，会出现过拟合的现象。

# 三、模型（GBDT/LGBM/XGBoost）细节说明
## 1. 模型核心参数与性能关系
树深度（max_depth）：
    直接影响模型复杂度：max_depth=5（所有模型默认参数）属于中等深度，过深（如 > 10）可能导致过拟合（模型记住训练数据细节），过浅（如 < 3）可能欠拟合（无法捕捉特征与目标的关系）。
    LGBM 额外通过num_leaves控制复杂度（num_leaves=31），其与max_depth存在近似关系（num_leaves≈2^max_depth），避免叶子数过多导致过拟合。

迭代次数（n_estimators）： GBDT/LGBM 设为 100，XGBoost 设为 50，代表树的数量。

采样参数：LGBM 和 XGBoost 通过subsample=0.8（样本采样）和colsample_bytree=0.8（特征采样）减少过拟合风险，通过随机性增强模型泛化能力。

## 2. 模型学习到的规律（从数据中提取的 “智能”）
关键影响因素：模型通过特征重要性识别对High Price影响最大的特征，例如：

分类特征：特定产地（如优质产区）、规格（如大尺寸南瓜）的价格显著更高（与plot_categorical_vs_target的可视化结果一致）。

数值特征：与High Price相关性高的特征可能成为核心分裂依据（例如重量越大，价格越高）。

误差模式：通过show_and_export函数分析残差可知：
    残差分布较均匀说明模型对大多数样本预测准确；若某类样本（如特定产地）残差始终较大，可能该类样本特征存在特殊规律未被模型捕捉。
    关键样本（best5/worst5/median5）显示：预测误差小的样本（best5）通常特征符合模型学习到的主流规律，而误差大的样本（worst5）可能包含异常值或未被捕捉的特殊因素（如突发天气影响价格）。

## 3. 模型评估与过拟合控制
评估指标：通过 MSE（均方误差）和 R²（决定系数）评估性能，R² 越接近 1 说明模型解释能力越强。

过拟合判断：对比训练集与测试集性能（evaluate_model函数），若训练集 MSE 远小于测试集，可能存在过拟合，可通过减小max_depth、增加采样随机性等方式优化。